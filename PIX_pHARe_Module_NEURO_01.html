<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIX-pHARe | Module NEURO 01 - Comprendre l‚ÄôAutre</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&family=Share+Tech+Mono&display=swap');
        :root {
            --neuro-blue: #7EC7E6;
            --neuro-green: #32B185;
            --neuro-accent: #01A6B5;
            --neuro-dark: #1A2831;
            --neuro-paper: #f7f4ea;
            --neuro-bronze: #b18956;
            --neuro-sepia: #d6b46a;
            --panel-bg: #f7f4ea;
            --panel-shadow: 0 6px 32px rgba(126,199,230,0.13), 0 0 0 1px rgba(1,166,181,0.13);
            --text-primary: #223444;
            --text-secondary: #5b7690;
            --accent-gradient: linear-gradient(90deg,#7EC7E6 0%,#32B185 60%,#d6b46a 100%);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--panel-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .app-container {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            text-align: center;
            padding: 36px 20px 24px 20px;
        }
        .pillar-icon {
            font-size: 3rem;
            margin-bottom: 12px;
            filter: drop-shadow(0 0 15px var(--neuro-blue));
        }
        .glitch-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.8rem, 5vw, 2.7rem);
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }
        .subtitle {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            color: var(--neuro-accent);
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .module-badge {
            display: inline-block;
            margin-top: 18px;
            padding: 10px 28px;
            background: linear-gradient(135deg, #7EC7E633, #b1895633);
            border: 2px solid var(--neuro-bronze);
            color: var(--neuro-bronze);
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.93rem;
            clip-path: polygon(10px 0%, calc(100% - 10px) 0%, 100% 50%, calc(100% - 10px) 100%, 10px 100%, 0% 50%);
        }
        .progress-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 26px 0 18px 0;
            flex-wrap: wrap;
        }
        .progress-node {
            width: 54px; height: 54px;
            border: 3px solid var(--neuro-sepia);
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 1.15rem;
            color: var(--neuro-sepia);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transition: all 0.4s;
        }
        .progress-node.active {
            border-color: var(--neuro-accent);
            color: var(--neuro-accent);
            box-shadow: 0 0 18px #01a6b558;
        }
        .progress-node.completed {
            border-color: var(--neuro-green);
            background: #E9F7F4;
            color: var(--neuro-green);
        }
        .xp-display {
            display: flex;
            justify-content: center;
            gap: 22px;
            margin-bottom: 26px;
            flex-wrap: wrap;
        }
        .xp-box {
            background: #eaf7fc;
            border: 2px solid var(--neuro-blue);
            padding: 12px 22px;
            text-align: center;
            clip-path: polygon(8px 0%, calc(100% - 8px) 0%, 100% 8px, 100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0% calc(100% - 8px), 0% 8px);
        }
        .xp-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.73rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1.7px;
        }
        .xp-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neuro-accent);
        }
        .content-panel {
            background: #fffdfa;
            border: 2px solid #7ec7e640;
            border-radius: 10px;
            margin-bottom: 18px;
            position: relative;
            box-shadow: var(--panel-shadow);
        }
        .content-panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }
        .panel-header {
            background: linear-gradient(135deg, #eaf7fc, #f6f4ec);
            padding: 15px 22px;
            border-bottom: 1px solid #7ec7e640;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 8px 8px 0 0;
        }
        .panel-icon {
            width: 44px; height: 44px;
            background: linear-gradient(135deg, var(--neuro-accent), #7EC7E6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            border-radius: 50%;
        }
        .panel-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.06rem;
            font-weight: 700;
            color: var(--neuro-accent);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        .panel-body { padding: 22px; }
        .intro-screen { text-align: center; padding: 22px 14px 30px 14px; }
        .name-input-group { margin: 22px auto 0 auto; max-width: 330px; }
        .name-input {
            width: 100%;
            padding: 12px;
            background: #f5fbfc;
            border: 2px solid var(--neuro-accent);
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            margin-bottom: 13px;
            border-radius: 6px;
        }
        .name-input:focus { outline: none; border-color: var(--neuro-green); box-shadow: 0 0 9px #32b18546; }
        .name-input::placeholder { color: #adc3cc; }
        /* FLASHCARDS */
        .flashcard-container { perspective: 1100px; margin-bottom: 20px; }
        .flashcard {
            position: relative;
            width: 100%;
            min-height: 210px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .flashcard.flipped { transform: rotateY(180deg); }
        .flashcard-face {
            position: absolute;
            width: 100%;
            min-height: 210px;
            backface-visibility: hidden;
            border: 2px solid var(--neuro-blue);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 18px;
            background: #eaf7fc;
            border-radius: 9px;
        }
        .flashcard-front { background: linear-gradient(135deg, #eaf7fc 80%, #f6f4ec 100%); }
        .flashcard-back { transform: rotateY(180deg); background: #f6f4ec; border-color: var(--neuro-green); }
        .flashcard-question {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--neuro-accent);
            text-align: center;
            margin-bottom: 13px;
        }
        .flashcard-hint {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.86rem;
            color: var(--neuro-blue);
            text-align: center;
        }
        .flashcard-answer {
            font-size: 1rem;
            line-height: 1.7;
            color: var(--text-primary);
            font-style: italic;
        }
        .flashcard-source { color: var(--neuro-green); font-size: 0.93em; margin-top: 11px; text-align: right; }
        .flashcard-nav {
            display: flex;
            justify-content: center;
            gap: 14px;
            margin-top: 15px;
        }
        .nav-btn {
            background: transparent;
            border: 2px solid var(--neuro-blue);
            color: var(--neuro-blue);
            padding: 10px 23px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.93rem;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        .nav-btn:hover { background: #7ec7e61a; box-shadow: 0 0 7px #7ec7e640; }
        .nav-btn:disabled { opacity: 0.34; cursor: not-allowed; }
        /* Quiz styles */
        .quiz-question {
            font-size: 1.08rem;
            font-weight: 600;
            margin-bottom: 17px;
            padding: 17px;
            background: linear-gradient(135deg, #eaf7fc 90%, #f6f4ec 100%);
            border-left: 4px solid var(--neuro-accent);
            border-radius: 5px 0 0 5px;
        }
        .quiz-options { display: flex; flex-direction: column; gap: 11px; }
        .quiz-option {
            background: #f5fbfc;
            border: 2px solid #d3ecf7;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.25s;
            display: flex;
            align-items: center;
            gap: 14px;
            border-radius: 5px;
        }
        .quiz-option:hover:not(.selected):not(.correct):not(.incorrect) {
            border-color: var(--neuro-accent);
            background: #eaf7fc;
            transform: translateX(5px);
        }
        .quiz-option.selected { border-color: var(--neuro-blue); background: #cbe6f1; }
        .quiz-option.correct { border-color: var(--neuro-green); background: #c7f2e4; }
        .quiz-option.incorrect { border-color: var(--neuro-bronze); background: #f3e7cf; }
        .option-marker {
            width: 33px; height: 33px;
            border: 2px solid currentColor;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            border-radius: 50%;
        }
        .option-text { flex: 1; font-size: 0.98rem; }
        .feedback-box {
            margin-top: 17px;
            padding: 17px;
            border-left: 4px solid var(--neuro-green);
            background: #e2f5ee;
            border-radius: 5px;
        }
        .feedback-box.incorrect-feedback { border-color: var(--neuro-bronze); background: #f6e9d4; }
        .feedback-title {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            color: var(--neuro-green);
            margin-bottom: 8px;
        }
        .feedback-box.incorrect-feedback .feedback-title { color: var(--neuro-bronze); }
        /* Scenario styles */
        .scenario-context {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.93rem;
            color: var(--neuro-bronze);
            margin-bottom: 13px;
            padding: 10px 13px;
            background: #f3e7cf;
            border: 1px dashed var(--neuro-bronze);
            border-radius: 4px;
        }
        .scenario-intro {
            font-size: 1.02rem;
            line-height: 1.7;
            margin-bottom: 17px;
            padding: 13px;
            background: #eaf7fc;
            border: 1px solid #cbe6f1;
            border-radius: 4px;
        }
        .choice-btn {
            display: block;
            width: 100%;
            background: #f6f4ec;
            border: 2px solid #d3ecf7;
            padding: 14px 13px;
            margin-bottom: 10px;
            text-align: left;
            cursor: pointer;
            transition: all 0.25s;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            color: var(--text-primary);
            border-radius: 6px;
        }
        .choice-btn:hover { border-color: var(--neuro-accent); background: #eaf7fc; transform: translateX(5px); }
        .choice-result {
            margin-top: 17px;
            padding: 15px;
            background: #f5fbfc;
            border: 2px solid var(--neuro-green);
            border-radius: 7px;
        }
        .impact-score {
            display: flex;
            gap: 14px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .impact-item {
            padding: 7px 13px;
            background: #eaf7fc;
            border: 1px solid var(--neuro-accent);
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.86rem;
            border-radius: 6px;
        }
        .impact-item.positive { border-color: var(--neuro-green); color: var(--neuro-green); }
        .impact-item.negative { border-color: var(--neuro-bronze); color: var(--neuro-bronze); }
        .action-btn {
            display: inline-block;
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 12px 33px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1.7px;
            transition: all 0.25s;
            border-radius: 24px;
            margin-top: 8px;
        }
        .action-btn:hover { transform: scale(1.07); box-shadow: 0 0 15px #7ec7e644; }
        .action-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .completion-screen { text-align: center; padding: 46px 17px 38px 17px; }
        .completion-icon {
            font-size: 5rem;
            margin-bottom: 19px;
            animation: neuroPulse 2.1s ease-in-out infinite;
        }
        @keyframes neuroPulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.12) rotate(3deg); }
        }
        .completion-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.1rem;
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 13px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(138px, 1fr));
            gap: 19px;
            margin: 25px 0;
        }
        .stat-card {
            background: #f5fbfc;
            border: 2px solid var(--neuro-accent);
            padding: 16px;
            text-align: center;
            border-radius: 9px;
        }
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.42rem;
            font-weight: 700;
            color: var(--neuro-accent);
        }
        .stat-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.86rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-top: 5px;
        }
        .save-code-box {
            background: #f5fbfc;
            border: 2px solid var(--neuro-green);
            padding: 18px;
            margin: 19px 0 0 0;
            border-radius: 7px;
        }
        .save-code-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.89rem;
            color: var(--neuro-green);
            margin-bottom: 8px;
        }
        .save-code {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.78rem;
            color: var(--neuro-accent);
            word-break: break-all;
            background: #eaf7fc;
            padding: 12px;
            border: 1px dashed var(--neuro-accent);
            border-radius: 5px;
        }
        .copy-btn {
            margin-top: 11px;
            background: transparent;
            border: 2px solid var(--neuro-green);
            color: var(--neuro-green);
            padding: 7px 19px;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.22s;
        }
        .copy-btn:hover { background: #32b18518; }
        .mastery-badge {
            display: inline-block;
            padding: 9px 22px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 0.92rem;
            text-transform: uppercase;
            border: 2px solid;
            margin-top: 13px;
            border-radius: 8px;
        }
        .mastery-expert { color: var(--neuro-accent); border-color: var(--neuro-accent); box-shadow: 0 0 10px #01a6b555; }
        .mastery-confirmed { color: var(--neuro-blue); border-color: var(--neuro-blue); }
        .mastery-training { color: var(--neuro-green); border-color: var(--neuro-green); }
        @media (max-width: 600px) {
            .glitch-title { font-size: 1.3rem; }
            .progress-node { width: 39px; height: 39px; font-size: 0.93rem; }
            .panel-body { padding: 11px; }
            .flashcard-face { padding: 13px 9px; min-height: 160px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script>
        const { useState } = React;
        const e = React.createElement;
        // --- DATA NEURO 01 ---
        const MODULE_ID = "NEURO_01";
        const MODULE_VERSION = "1.0";
        const MODULE_TITLE = "Comprendre l‚ÄôAutre";
        // --- FLASHCARDS ---
        const flashcardsData = [
            {
                question: "L‚Äôempathie est-elle une seule capacit√© ?",
                hint: "[ Clique pour r√©v√©ler ]",
                answer: "Non. Elle comporte deux dimensions : <b>comprendre</b> ce que vit l‚Äôautre et <b>ressentir</b> ce qu‚Äôil ressent.",
                source: "Neurosciences affectives"
            },
            {
                question: "Qu‚Äôest-ce que l‚Äôempathie cognitive ?",
                hint: "[ Clique pour r√©v√©ler ]",
                answer: "C‚Äôest la capacit√© √† <b>comprendre</b> les pens√©es, intentions et √©motions d‚Äôautrui sans forc√©ment les ressentir.",
                source: "Th√©orie de l‚Äôesprit"
            },
            {
                question: "Qu‚Äôest-ce que l‚Äôempathie affective ?",
                hint: "[ Clique pour r√©v√©ler ]",
                answer: "C‚Äôest la capacit√© √† <b>ressentir</b> une r√©sonance √©motionnelle face √† la souffrance ou √† la joie d‚Äôautrui.",
                source: "Psychologie √©motionnelle"
            },
            {
                question: "Pourquoi peut-on comprendre sans ressentir ?",
                hint: "[ Clique pour r√©v√©ler ]",
                answer: "Parce que ces deux formes d‚Äôempathie reposent sur des <b>circuits c√©r√©braux diff√©rents</b>.",
                source: "Neurobiologie"
            },
            {
                question: "Pourquoi les deux doivent fonctionner ensemble ?",
                hint: "[ Clique pour r√©v√©ler ]",
                answer: "Comprendre sans ressentir peut conduire √† <b>manipuler</b>.<br>Ressentir sans comprendre peut <b>paralyser</b>.",
                source: "Approche √©ducative"
            }
        ];
        // --- QUIZ ---
        const quizData = [
            {
                question: "Un √©l√®ve rep√®re tr√®s bien les faiblesses d‚Äôun camarade. Quelle capacit√© utilise-t-il principalement ?",
                options: [
                    "L‚Äôempathie cognitive",
                    "L‚Äôempathie affective"
                ],
                correct: 0,
                feedback: "Exact. Il comprend l‚Äôautre sans n√©cessairement ressentir."
            }
        ];
        // --- SCENARIO ---
        const scenarioData = [
            {
                title: "Reconnecter comprendre et ressentir",
                context: "Un √©l√®ve se moque en sachant que l‚Äôautre souffre.",
                intro: "Quel est le d√©s√©quilibre principal ?",
                choices: [
                    { text: "Compr√©hension sans r√©sonance √©motionnelle", result: "Exact. Le ressenti est absent.", impact: { neuro: +100 } },
                    { text: "Manque d‚Äôintelligence", result: "Non. Le probl√®me n‚Äôest pas intellectuel.", impact: { neuro: -20 } }
                ]
            }
        ];
        // --- UTILS ---
        function encodeSaveCode(data) { return btoa(JSON.stringify(data)); }
        function getMasteryLevel(score) {
            if (score >= 130) return { level: "Expert", class: "mastery-expert" };
            if (score >= 80) return { level: "Confirm√©", class: "mastery-confirmed" };
            return { level: "En formation", class: "mastery-training" };
        }
        // --- MAIN APP ---
        function App() {
            const [gameState, setGameState] = useState("intro");
            const [playerData, setPlayerData] = useState({ name: "", class: "", score: 0, xp: 0, quizScore: 0, scenarioScore: 0, flashcardsViewed: 0 });
            const [currentFlashcard, setCurrentFlashcard] = useState(0);
            const [flashcardFlipped, setFlashcardFlipped] = useState(false);
            const [currentQuiz, setCurrentQuiz] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showQuizFeedback, setShowQuizFeedback] = useState(false);
            const [currentScenario, setCurrentScenario] = useState(0);
            const [scenarioChoice, setScenarioChoice] = useState(null);
            const [showScenarioResult, setShowScenarioResult] = useState(false);
            function startGame() {
                if (playerData.name.trim()) setGameState("flashcards");
            }
            function nextFlashcard() {
                if (currentFlashcard < flashcardsData.length - 1) {
                    setCurrentFlashcard(prev => prev + 1);
                    setFlashcardFlipped(false);
                    setPlayerData(prev => ({ ...prev, flashcardsViewed: Math.max(prev.flashcardsViewed, currentFlashcard + 2), xp: prev.xp + 12 }));
                } else {
                    setGameState("quiz");
                    setPlayerData(prev => ({ ...prev, flashcardsViewed: flashcardsData.length, xp: prev.xp + 50 }));
                }
            }
            function prevFlashcard() { if (currentFlashcard > 0) { setCurrentFlashcard(prev => prev - 1); setFlashcardFlipped(false); } }
            function selectQuizAnswer(index) { if (!showQuizFeedback) setSelectedAnswer(index); }
            function validateQuizAnswer() {
                setShowQuizFeedback(true);
                if (selectedAnswer === quizData[currentQuiz].correct) {
                    setPlayerData(prev => ({ ...prev, score: prev.score + 30, quizScore: prev.quizScore + 30, xp: prev.xp + 30 }));
                }
            }
            function nextQuizQuestion() {
                setShowQuizFeedback(false);
                setSelectedAnswer(null);
                setCurrentQuiz(prev => prev + 1);
                setGameState("scenarios");
                setPlayerData(prev => ({ ...prev, xp: prev.xp + 30 }));
            }
            function makeScenarioChoice(index) {
                setScenarioChoice(index);
                setShowScenarioResult(true);
                const choice = scenarioData[currentScenario].choices[index];
                const values = Object.values(choice.impact);
                const totalChange = Math.max(0, values.reduce((a, b) => a + b, 0));
                setPlayerData(prev => ({ ...prev, score: prev.score + totalChange, scenarioScore: prev.scenarioScore + totalChange, xp: prev.xp + 25 }));
            }
            function nextScenario() {
                setGameState("complete");
                setPlayerData(prev => ({ ...prev, xp: prev.xp + 50 }));
            }
            function generateSaveCode() {
                return encodeSaveCode({
                    v: 1, d: new Date().toISOString(), m: MODULE_ID, mv: MODULE_VERSION,
                    n: playerData.name, c: playerData.class, l: 3, s: playerData.score,
                    x: playerData.xp, q: playerData.quizScore, sc: playerData.scenarioScore, f: true
                });
            }
            function copyCode() { navigator.clipboard.writeText(generateSaveCode()).then(() => alert("Code copi√© !")); }
            // RENDERING
            function renderIntro() {
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("div", { className: "pillar-icon" }, "üß†"),
                        e("h1", { className: "glitch-title" }, "PIX-pHARe"),
                        e("div", { className: "subtitle" }, "Pilier Neurosciences & Empathie"),
                        e("div", { className: "module-badge" }, "MODULE 01")
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" },
                            e("div", { className: "panel-icon" }, "üß¨"),
                            e("div", { className: "panel-title" }, MODULE_TITLE)
                        ),
                        e("div", { className: "panel-body" },
                            e("div", { className: "intro-screen" },
                                e("p", { style: { fontSize: "1.1rem", marginBottom: "19px" } },
                                    "Comprendre l‚Äôempathie, c‚Äôest apprendre √† connecter ",
                                    e("b", { style: { color: "var(--neuro-green)" } }, "cerveau et c≈ìur"),
                                    ", pour se prot√©ger ET prot√©ger l‚Äôautre."
                                ),
                                e("p", { style: { color: "var(--text-secondary)", marginBottom: "22px" } },
                                    "D√©couvre comment l‚Äôhumain peut comprendre‚Ä¶ ou manipuler."
                                ),
                                e("div", { className: "name-input-group" },
                                    e("input", {
                                        type: "text",
                                        className: "name-input",
                                        value: playerData.name,
                                        onChange: ev => setPlayerData(prev => ({ ...prev, name: ev.target.value })),
                                        placeholder: "Ton pr√©nom ou pseudo..."
                                    }),
                                    e("input", {
                                        type: "text",
                                        className: "name-input",
                                        value: playerData.class,
                                        onChange: ev => setPlayerData(prev => ({ ...prev, class: ev.target.value })),
                                        placeholder: "Ta classe (optionnel)..."
                                    })
                                ),
                                e("button", { className: "action-btn", onClick: startGame, disabled: !playerData.name.trim() }, "[ COMMENCER ]")
                            )
                        )
                    )
                );
            }
            function renderFlashcards() {
                const card = flashcardsData[currentFlashcard];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("h1", { className: "glitch-title" }, MODULE_TITLE),
                        e("div", { className: "subtitle" }, "Niveau 1 : Th√©orie")
                    ),
                    e("div", { className: "progress-bar" },
                        e("div", { className: "progress-node active" }, "1"),
                        e("div", { className: "progress-node" }, "2"),
                        e("div", { className: "progress-node" }, "3")
                    ),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Concept"), e("div", { className: "xp-value" }, `${currentFlashcard + 1}/${flashcardsData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" },
                            e("div", { className: "panel-icon" }, "üìö"),
                            e("div", { className: "panel-title" }, "Scanner et haut-parleur")
                        ),
                        e("div", { className: "panel-body" },
                            e("div", { className: "flashcard-container" },
                                e("div", { className: `flashcard ${flashcardFlipped ? "flipped" : ""}`, onClick: () => setFlashcardFlipped(!flashcardFlipped) },
                                    e("div", { className: "flashcard-face flashcard-front" },
                                        e("div", { className: "flashcard-question" }, card.question),
                                        e("div", { className: "flashcard-hint" }, card.hint)
                                    ),
                                    e("div", { className: "flashcard-face flashcard-back" },
                                        e("div", { className: "flashcard-answer", dangerouslySetInnerHTML: { __html: card.answer } }),
                                        e("div", { className: "flashcard-source" }, card.source)
                                    )
                                )
                            ),
                            e("div", { className: "flashcard-nav" },
                                e("button", { className: "nav-btn", onClick: prevFlashcard, disabled: currentFlashcard === 0 }, "‚óÑ PR√âC"),
                                e("button", { className: "nav-btn", onClick: nextFlashcard }, currentFlashcard < flashcardsData.length - 1 ? "SUIV ‚ñ∫" : "NIVEAU 2 ‚ñ∫")
                            )
                        )
                    )
                );
            }
            function renderQuiz() {
                const question = quizData[currentQuiz];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("h1", { className: "glitch-title" }, MODULE_TITLE),
                        e("div", { className: "subtitle" }, "Niveau 2 : Analyse")
                    ),
                    e("div", { className: "progress-bar" },
                        e("div", { className: "progress-node completed" }, "‚úì"),
                        e("div", { className: "progress-node active" }, "2"),
                        e("div", { className: "progress-node" }, "3")
                    ),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Score"), e("div", { className: "xp-value" }, playerData.quizScore)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Question"), e("div", { className: "xp-value" }, `${currentQuiz + 1}/${quizData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" },
                            e("div", { className: "panel-icon" }, "üî¨"),
                            e("div", { className: "panel-title" }, "Comprendre n‚Äôest pas excuser")
                        ),
                        e("div", { className: "panel-body" },
                            e("div", { className: "quiz-question" }, question.question),
                            e("div", { className: "quiz-options" },
                                question.options.map((opt, idx) => {
                                    let optClass = "quiz-option";
                                    if (showQuizFeedback) {
                                        if (idx === question.correct) optClass += " correct";
                                        else if (idx === selectedAnswer) optClass += " incorrect";
                                    } else if (idx === selectedAnswer) optClass += " selected";
                                    return e("div", {
                                        key: idx, className: optClass,
                                        onClick: () => selectQuizAnswer(idx)
                                    },
                                        e("div", { className: "option-marker" }, String.fromCharCode(65 + idx)),
                                        e("div", { className: "option-text" }, opt)
                                    );
                                })
                            ),
                            showQuizFeedback && e("div", {
                                className: `feedback-box ${selectedAnswer === question.correct ? "" : "incorrect-feedback"}`
                            },
                                e("div", { className: "feedback-title" }, selectedAnswer === question.correct ? "‚úîÔ∏è Bonne r√©ponse" : "‚ùå Mauvaise r√©ponse"),
                                e("div", null, question.feedback)
                            ),
                            !showQuizFeedback ?
                                e("button", {
                                    className: "action-btn",
                                    disabled: selectedAnswer === null,
                                    onClick: validateQuizAnswer
                                }, "VALIDER") :
                                e("button", {
                                    className: "action-btn",
                                    onClick: nextQuizQuestion
                                }, "SUIVANT ‚ñ∫")
                        )
                    )
                );
            }
            function renderScenario() {
                const scenario = scenarioData[currentScenario];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("h1", { className: "glitch-title" }, MODULE_TITLE),
                        e("div", { className: "subtitle" }, "Niveau 3 : Dojo")
                    ),
                    e("div", { className: "progress-bar" },
                        e("div", { className: "progress-node completed" }, "‚úì"),
                        e("div", { className: "progress-node completed" }, "‚úì"),
                        e("div", { className: "progress-node active" }, "3")
                    ),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Score"), e("div", { className: "xp-value" }, playerData.scenarioScore)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Sc√©nario"), e("div", { className: "xp-value" }, `${currentScenario + 1}/${scenarioData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" },
                            e("div", { className: "panel-icon" }, "üß†"),
                            e("div", { className: "panel-title" }, scenario.title)
                        ),
                        e("div", { className: "panel-body" },
                            e("div", { className: "scenario-context" }, scenario.context),
                            e("div", { className: "scenario-intro" }, scenario.intro),
                            !showScenarioResult ? scenario.choices.map((ch, idx) =>
                                e("button", {
                                    key: idx, className: "choice-btn", onClick: () => makeScenarioChoice(idx)
                                }, ch.text)
                            ) : e("div", { className: "choice-result" },
                                e("div", null, scenario.choices[scenarioChoice].result),
                                e("div", { className: `impact-score ${scenario.choices[scenarioChoice].impact.neuro >= 0 ? "positive" : "negative"}` },
                                    e("div", { className: "impact-item" + (scenario.choices[scenarioChoice].impact.neuro >= 0 ? " positive" : " negative") },
                                        scenario.choices[scenarioChoice].impact.neuro >= 0 ? `+${scenario.choices[scenarioChoice].impact.neuro} NEURO` : `${scenario.choices[scenarioChoice].impact.neuro} NEURO`
                                    )
                                ),
                                e("button", { className: "action-btn", onClick: nextScenario }, "VOIR MON R√âSULTAT FINAL")
                            )
                        )
                    )
                );
            }
            function renderCompletion() {
                const mastery = getMasteryLevel(playerData.score);
                return e("div", { className: "app-container" },
                    e("div", { className: "completion-screen" },
                        e("div", { className: "completion-icon" }, "üèÖ"),
                        e("div", { className: "completion-title" }, "MODULE TERMIN√â !"),
                        e("div", { className: "stats-grid" },
                            e("div", { className: "stat-card" },
                                e("div", { className: "stat-value" }, playerData.xp),
                                e("div", { className: "stat-label" }, "XP Total")
                            ),
                            e("div", { className: "stat-card" },
                                e("div", { className: "stat-value" }, playerData.score),
                                e("div", { className: "stat-label" }, "Score")
                            ),
                            e("div", { className: "stat-card" },
                                e("div", { className: "stat-value" }, playerData.quizScore),
                                e("div", { className: "stat-label" }, "Quiz")
                            ),
                            e("div", { className: "stat-card" },
                                e("div", { className: "stat-value" }, playerData.scenarioScore),
                                e("div", { className: "stat-label" }, "Dojo")
                            )
                        ),
                        e("div", { className: `mastery-badge ${mastery.class}` }, mastery.level),
                        e("div", { className: "save-code-box" },
                            e("div", { className: "save-code-label" }, "Code de sauvegarde :"),
                            e("div", { className: "save-code" }, generateSaveCode()),
                            e("button", { className: "copy-btn", onClick: copyCode }, "COPIER")
                        ),
                        e("div", { style: { marginTop: 19, color: "var(--neuro-bronze)" } },
                            "Tu peux transmettre ce code √† ton enseignant ou le garder pour valider tes acquis."
                        ),
                        e("button", { className: "action-btn", style: { marginTop: 24 }, onClick: () => window.location.reload() }, "‚Üª RECOMMENCER")
                    )
                );
            }
            // ROUTING
            switch (gameState) {
                case "intro": return renderIntro();
                case "flashcards": return renderFlashcards();
                case "quiz": return renderQuiz();
                case "scenarios": return renderScenario();
                case "complete": return renderCompletion();
                default: return e("div", null, "Oops.");
            }
        }
        ReactDOM.createRoot(document.getElementById('root')).render(e(App));
    </script>
</body>
</html>
