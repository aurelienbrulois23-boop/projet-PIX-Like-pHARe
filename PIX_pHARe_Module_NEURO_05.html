<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIX-pHARe | Module HISTOIRE 05 - Comprendre pour Pr√©venir [CERTIFICATION]</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&family=Share+Tech+Mono&display=swap');
        
        :root {
            --history-bronze: #cd7f32;
            --history-amber: #d4a574;
            --history-sepia: #b08968;
            --history-parchment: #e8d5b5;
            --history-ink: #2c1810;
            --void-dark: #0a0a0a;
            --deep-dark: #050505;
            --panel-bg: rgba(44, 24, 16, 0.95);
            --text-primary: #f5ede4;
            --text-secondary: #a89984;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--void-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .leader-bg {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                radial-gradient(ellipse at 50% 20%, rgba(205, 127, 50, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 30% 70%, rgba(176, 137, 104, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(212, 165, 116, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
            animation: historyGlow 8s ease-in-out infinite;
        }
        
        @keyframes historyGlow {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.9; }
        }
        
        .stars-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, rgba(251, 191, 36, 0.8), transparent),
                radial-gradient(2px 2px at 40% 70%, rgba(16, 185, 129, 0.6), transparent),
                radial-gradient(2px 2px at 70% 20%, rgba(139, 92, 246, 0.6), transparent),
                radial-gradient(1px 1px at 90% 50%, rgba(251, 191, 36, 0.5), transparent),
                radial-gradient(1px 1px at 10% 90%, rgba(6, 182, 212, 0.5), transparent);
            background-size: 200px 200px;
            animation: starsTwinkle 4s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes starsTwinkle {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        .app-container {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header { text-align: center; padding: 40px 20px; }
        
        .pillar-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 20px rgba(205, 127, 50, 0.7));
            animation: bookPulse 3s ease-in-out infinite;
        }
        
        @keyframes bookPulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 20px rgba(205, 127, 50, 0.7)); }
            50% { transform: scale(1.08); filter: drop-shadow(0 0 30px rgba(205, 127, 50, 0.9)); }
        }
        
        .glitch-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--neuro-primary), var(--neuro-accent), var(--neuro-success), var(--neuro-mind));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 5s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .subtitle {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            color: var(--leader-gold);
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 4px;
        }
        
        .module-badge {
            display: inline-block;
            margin-top: 20px;
            padding: 15px 40px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.3), rgba(139, 92, 246, 0.2));
            border: 3px solid var(--leader-gold);
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--leader-gold);
            text-transform: uppercase;
            letter-spacing: 3px;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.4);
        }
        
        .progress-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .progress-node {
            width: 60px; height: 60px;
            border: 3px solid var(--text-secondary);
            background: var(--deep-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--text-secondary);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            transition: all 0.4s ease;
        }
        
        .progress-node.active {
            border-color: var(--leader-gold);
            color: var(--leader-gold);
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.6);
            animation: hexPulse 2s ease-in-out infinite;
        }
        
        @keyframes hexPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .progress-node.completed {
            border-color: var(--leader-emerald);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(251, 191, 36, 0.2));
            color: var(--leader-emerald);
        }
        
        .xp-display {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .xp-box {
            background: var(--panel-bg);
            border: 2px solid var(--leader-gold);
            padding: 15px 25px;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
        }
        
        .xp-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        
        .xp-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--leader-gold);
        }
        
        .content-panel {
            background: var(--panel-bg);
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .content-panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--leader-gold), var(--leader-emerald), var(--leader-purple), var(--leader-cyan), var(--leader-gold));
            background-size: 200% 100%;
            animation: rainbowBar 3s linear infinite;
        }
        
        @keyframes rainbowBar {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        .panel-header {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(139, 92, 246, 0.1));
            padding: 20px 25px;
            border-bottom: 1px solid rgba(251, 191, 36, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .panel-icon {
            width: 55px; height: 55px;
            background: linear-gradient(135deg, var(--leader-gold), var(--leader-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        
        .panel-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--leader-gold);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .panel-body { padding: 25px; }
        
        .unlock-screen { text-align: center; padding: 40px 20px; }
        .lock-icon { font-size: 4rem; margin-bottom: 20px; animation: crownPulse 3s ease-in-out infinite; }
        .unlock-title { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--leader-gold); margin-bottom: 15px; }
        
        .code-input {
            width: 100%;
            max-width: 500px;
            padding: 15px;
            background: var(--deep-dark);
            border: 2px solid var(--leader-gold);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            margin: 20px auto;
            display: block;
        }
        
        .code-input:focus { outline: none; border-color: var(--leader-emerald); box-shadow: 0 0 20px rgba(16, 185, 129, 0.4); }
        
        .error-msg { color: #ef4444; font-family: 'Share Tech Mono', monospace; margin-top: 15px; padding: 10px; border: 1px solid #ef4444; border-radius: 10px; background: rgba(239, 68, 68, 0.1); }
        
        .synthesis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .synthesis-card {
            background: var(--deep-dark);
            border: 2px solid;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .synthesis-card.m1 { border-color: #ef4444; }
        .synthesis-card.m2 { border-color: var(--leader-amber); }
        .synthesis-card.m3 { border-color: var(--leader-purple); }
        .synthesis-card.m4 { border-color: var(--leader-emerald); }
        
        .synthesis-title { font-family: 'Orbitron', sans-serif; font-size: 0.85rem; margin-bottom: 8px; }
        .synthesis-card.m1 .synthesis-title { color: #ef4444; }
        .synthesis-card.m2 .synthesis-title { color: var(--leader-amber); }
        .synthesis-card.m3 .synthesis-title { color: var(--leader-purple); }
        .synthesis-card.m4 .synthesis-title { color: var(--leader-emerald); }
        
        .synthesis-content { font-size: 0.85rem; color: var(--text-secondary); }
        
        .flashcard-container { perspective: 1200px; margin-bottom: 20px; }
        
        .flashcard {
            position: relative;
            width: 100%;
            min-height: 280px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .flashcard.flipped { transform: rotateY(180deg); }
        
        .flashcard-face {
            position: absolute;
            width: 100%;
            min-height: 280px;
            backface-visibility: hidden;
            border: 3px solid var(--leader-gold);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 25px;
            background: var(--deep-dark);
        }
        
        .flashcard-front { background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(139, 92, 246, 0.05)); }
        
        .flashcard-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(251, 191, 36, 0.1));
            border-color: var(--leader-emerald);
        }
        
        .flashcard-badge {
            position: absolute;
            top: 15px; right: 15px;
            padding: 8px 18px;
            background: linear-gradient(135deg, var(--leader-gold), var(--leader-purple));
            color: var(--deep-dark);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            border-radius: 20px;
        }
        
        .flashcard-question { font-family: 'Orbitron', sans-serif; font-size: 1.1rem; font-weight: 600; color: var(--leader-gold); text-align: center; margin-bottom: 15px; }
        .flashcard-hint { font-family: 'Share Tech Mono', monospace; font-size: 0.85rem; color: var(--leader-cyan); text-align: center; }
        .flashcard-answer { font-size: 1rem; line-height: 1.7; color: var(--text-primary); }
        .flashcard-answer strong { color: var(--leader-emerald); }
        .flashcard-answer .concept { color: var(--leader-gold); font-family: 'Orbitron', sans-serif; font-size: 0.9rem; }
        
        .flashcard-nav { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        
        .nav-btn {
            background: transparent;
            border: 2px solid var(--leader-gold);
            color: var(--leader-gold);
            padding: 12px 30px;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            border-radius: 25px;
        }
        
        .nav-btn:hover { background: rgba(251, 191, 36, 0.2); box-shadow: 0 0 20px rgba(251, 191, 36, 0.4); }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        
        .quiz-question {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(139, 92, 246, 0.05));
            border-left: 4px solid var(--leader-gold);
            border-radius: 0 15px 15px 0;
        }
        
        .quiz-options { display: flex; flex-direction: column; gap: 12px; }
        
        .quiz-option {
            background: var(--deep-dark);
            border: 2px solid var(--text-secondary);
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .quiz-option:hover:not(.selected):not(.correct):not(.incorrect) { border-color: var(--leader-gold); background: rgba(251, 191, 36, 0.1); transform: translateX(5px); }
        .quiz-option.selected { border-color: var(--leader-gold); background: rgba(251, 191, 36, 0.15); }
        .quiz-option.correct { border-color: var(--leader-emerald); background: rgba(16, 185, 129, 0.2); }
        .quiz-option.incorrect { border-color: #ef4444; background: rgba(239, 68, 68, 0.15); }
        
        .option-marker { width: 35px; height: 35px; border: 2px solid currentColor; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Orbitron', sans-serif; font-weight: 700; }
        .option-text { flex: 1; font-size: 0.95rem; }
        
        .feedback-box { margin-top: 20px; padding: 20px; border-left: 4px solid var(--leader-emerald); border-radius: 0 15px 15px 0; background: rgba(16, 185, 129, 0.1); }
        .feedback-box.incorrect-feedback { border-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
        .feedback-title { font-family: 'Orbitron', sans-serif; font-weight: 700; color: var(--leader-emerald); margin-bottom: 10px; }
        .feedback-box.incorrect-feedback .feedback-title { color: #ef4444; }
        
        .scenario-context { font-family: 'Share Tech Mono', monospace; font-size: 0.9rem; color: var(--leader-gold); margin-bottom: 15px; padding: 12px 15px; background: rgba(251, 191, 36, 0.1); border: 1px dashed var(--leader-gold); border-radius: 10px; }
        .scenario-intro { font-size: 1rem; line-height: 1.7; margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(139, 92, 246, 0.05)); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 15px; }
        
        .choice-btn {
            display: block;
            width: 100%;
            background: var(--deep-dark);
            border: 2px solid var(--text-secondary);
            border-radius: 12px;
            padding: 18px 20px;
            margin-bottom: 12px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            color: var(--text-primary);
        }
        
        .choice-btn:hover { border-color: var(--leader-gold); background: rgba(251, 191, 36, 0.1); transform: translateX(5px); }
        
        .choice-result { margin-top: 20px; padding: 20px; background: var(--deep-dark); border: 2px solid var(--leader-emerald); border-radius: 15px; }
        .impact-score { display: flex; gap: 15px; margin-top: 15px; flex-wrap: wrap; }
        .impact-item { padding: 8px 15px; background: rgba(251, 191, 36, 0.1); border: 1px solid var(--leader-gold); border-radius: 20px; font-family: 'Share Tech Mono', monospace; font-size: 0.85rem; }
        .impact-item.positive { border-color: var(--leader-emerald); color: var(--leader-emerald); }
        .impact-item.negative { border-color: #ef4444; color: #ef4444; }
        
        .action-btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--leader-gold), var(--leader-purple));
            color: var(--deep-dark);
            border: none;
            padding: 15px 40px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            border-radius: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
        }
        
        .action-btn:hover { transform: scale(1.05); box-shadow: 0 0 40px rgba(251, 191, 36, 0.6); }
        .action-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        
        .completion-screen { text-align: center; padding: 50px 20px; }
        .completion-icon { font-size: 5rem; margin-bottom: 20px; animation: crownPulse 3s ease-in-out infinite; }
        
        .completion-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--leader-gold), var(--leader-emerald), var(--leader-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }
        
        .certificate-frame {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(139, 92, 246, 0.1));
            border: 4px solid var(--leader-gold);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            position: relative;
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.3);
        }
        
        .certificate-frame::before, .certificate-frame::after {
            content: '‚òÖ';
            position: absolute;
            font-size: 2rem;
            color: var(--leader-gold);
        }
        
        .certificate-frame::before { top: 10px; left: 10px; }
        .certificate-frame::after { bottom: 10px; right: 10px; }
        
        .certificate-title { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: var(--leader-gold); margin-bottom: 15px; }
        .certificate-name { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; font-weight: 700; color: var(--leader-emerald); margin: 15px 0; }
        .certificate-text { color: var(--text-secondary); margin: 10px 0; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 20px; margin: 30px 0; }
        
        .stat-card {
            background: var(--panel-bg);
            border: 2px solid var(--leader-gold);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value { font-family: 'Orbitron', sans-serif; font-size: 2rem; font-weight: 700; color: var(--leader-gold); }
        .stat-label { font-family: 'Share Tech Mono', monospace; font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; margin-top: 5px; }
        
        .save-code-box { background: var(--deep-dark); border: 3px solid var(--leader-emerald); border-radius: 15px; padding: 25px; margin: 30px 0; box-shadow: 0 0 30px rgba(16, 185, 129, 0.3); }
        .save-code-label { font-family: 'Share Tech Mono', monospace; font-size: 0.9rem; color: var(--leader-emerald); margin-bottom: 10px; }
        .save-code { font-family: 'Share Tech Mono', monospace; font-size: 0.7rem; color: var(--leader-gold); word-break: break-all; background: rgba(251, 191, 36, 0.1); padding: 15px; border-radius: 10px; border: 1px dashed var(--leader-gold); }
        
        .copy-btn { margin-top: 15px; background: transparent; border: 2px solid var(--leader-emerald); color: var(--leader-emerald); padding: 10px 25px; font-family: 'Share Tech Mono', monospace; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; }
        .copy-btn:hover { background: rgba(16, 185, 129, 0.2); }
        
        .mastery-badge {
            display: inline-block;
            padding: 15px 35px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 1rem;
            text-transform: uppercase;
            border: 3px solid;
            border-radius: 30px;
            margin-top: 15px;
        }
        
        .mastery-master { color: var(--leader-gold); border-color: var(--leader-gold); box-shadow: 0 0 30px rgba(251, 191, 36, 0.6); animation: masterGlow 2s ease-in-out infinite; }
        .mastery-expert { color: var(--leader-emerald); border-color: var(--leader-emerald); box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
        .mastery-confirmed { color: var(--leader-cyan); border-color: var(--leader-cyan); }
        
        @keyframes masterGlow {
            0%, 100% { box-shadow: 0 0 30px rgba(251, 191, 36, 0.6); }
            50% { box-shadow: 0 0 50px rgba(251, 191, 36, 0.9); }
        }
        
        @media (max-width: 600px) {
            .glitch-title { font-size: 1.5rem; }
            .progress-node { width: 50px; height: 50px; font-size: 1rem; }
            .panel-body { padding: 15px; }
            .flashcard-face { padding: 20px 15px; min-height: 300px; }
            .synthesis-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <div class="leader-bg"></div>
    <div class="stars-overlay"></div>
    <div id="root"></div>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script>
        const { useState } = React;
        const e = React.createElement;

        const MODULE_ID = "HISTOIRE_05";
        const MODULE_TITLE = "Comprendre pour Pr√©venir";
        const PREREQUISITE_MODULE = "HISTOIRE_04";
        const PILLAR_ID = "HISTOIRE";
        
        const flashcardsData = [
            { badge: "LE√áON 1", question: "Pourquoi conna√Ætre l'histoire du harc√®lement est-il utile aujourd'hui ?", hint: "[ Cliquez pour r√©viser ]", answer: "Parce que les r√©ponses actuelles sont le fruit d'un <strong>long cheminement</strong>. Comprendre le pass√© √©vite de r√©p√©ter les m√™mes erreurs. Les lois, programmes (pHARe), num√©ros d'aide (3018) : tout est n√© de cette prise de conscience." },
            { badge: "LE√áON 2", question: "Qu'a montr√© l'absence de reconnaissance pass√©e ?", hint: "[ Cliquez pour r√©viser ]", answer: "Que le <strong>silence prot√®ge les violences</strong>. Sans cadre de r√©f√©rence, les victimes restent isol√©es et les auteurs impunis. <span class='concept'>Nommer = premi√®re √©tape de la lutte</span>." },
            { badge: "LE√áON 3", question: "Que r√©v√®le l'√©volution des r√©ponses sociales ?", hint: "[ Cliquez pour r√©viser ]", answer: "Un d√©placement progressif des responsabilit√©s : du <strong>silence individuel</strong> vers une <strong>responsabilit√© collective</strong>. On passe de 'd√©brouille-toi' √† 'c'est l'affaire de tous'." },
            { badge: "LE√áON 4", question: "Pourquoi la pr√©vention est-elle centrale aujourd'hui ?", hint: "[ Cliquez pour r√©viser ]", answer: "Parce que l'intervention tardive ne suffit pas. <strong>Pr√©venir = agir avant</strong> que la souffrance ne s'installe. Former, sensibiliser, cr√©er des normes positives : tout cela emp√™che le harc√®lement." },
            { badge: "LE√áON 5", question: "Quelle le√ßon tirer des p√©riodes de normalisation des violences ?", hint: "[ Cliquez pour r√©viser ]", answer: "Les normes sociales ne sont <strong>pas fig√©es</strong>. Ce qui √©tait accept√© hier (bizutage, violence ordinaire) peut √™tre refus√© aujourd'hui. <span class='concept'>Le changement est possible</span> mais n√©cessite action collective." },
            { badge: "INT√âGRATION", question: "Pourquoi le concept m√™me de harc√®lement a-t-il mis du temps √† √©merger ?", hint: "[ Cliquez pour comprendre ]", answer: "Car <strong>nommer un probl√®me n√©cessite un contexte culturel</strong> qui le reconna√Æt. Sans mot, pas de visibilit√©. Sans visibilit√©, pas d'action. L'histoire montre le pouvoir du langage." },
            { badge: "PR√âVENTION", question: "Quelle est la diff√©rence entre r√©action et pr√©vention ?", hint: "[ Cliquez pour comprendre ]", answer: "La r√©action intervient <strong>apr√®s le dommage</strong> (victimes d√©j√† touch√©es). La pr√©vention construit un <strong>environnement protecteur</strong> qui emp√™che le dommage. L'histoire enseigne : mieux vaut pr√©venir que gu√©rir." },
            { badge: "CERTIFICATION", question: "Quel est ton r√¥le dans cet h√©ritage historique ?", hint: "[ Cliquez pour comprendre ]", answer: "Tu es un <strong>maillon de la cha√Æne</strong>. Ceux avant toi ont nomm√©, l√©gif√©r√©, construit des programmes. Toi, tu les portes dans ton quotidien. <span class='concept'>Ta vigilance continue l'histoire</span>." }
        ];

        const quizData = [
            { question: "Pendant longtemps, le harc√®lement a √©t√© ignor√©. Quelle est la principale cons√©quence de ce constat aujourd'hui ?", options: ["La culpabilit√© des g√©n√©rations pr√©c√©dentes", "La n√©cessit√© d'agir collectivement et en amont", "L'impossibilit√© de changer les choses", "La responsabilit√© uniquement individuelle"], correct: 1, feedback: "Exact. L'histoire montre que l'inaction a un co√ªt humain √©lev√©. Les dispositifs modernes (pHARe, 3018, lois) naissent de cette prise de conscience. On passe du silence √† l'action collective." },
            { question: "Les dispositifs actuels s'appuient sur la pr√©vention. Pourquoi cette approche est-elle privil√©gi√©e ?", options: ["Parce qu'elle √©vite toute sanction", "Parce qu'elle r√©duit les risques avant l'apparition des violences", "Parce que c'est moins cher", "Parce que les adultes le demandent"], correct: 1, feedback: "Correct. Pr√©venir prot√®ge durablement. Former les t√©moins, enseigner l'empathie, cr√©er des normes anti-harc√®lement : tout cela emp√™che le harc√®lement de s'installer. La pr√©vention = l'aboutissement des le√ßons historiques." },
            { question: "Un √©l√®ve dit : 'De toute fa√ßon √ßa a toujours exist√©, on ne peut rien y faire.' Quelle r√©ponse s'appuie sur les enseignements historiques ?", options: ["'Tu as raison, c'est inutile de se battre'", "'L'histoire montre que les normes changent quand on agit collectivement'", "'C'est une fatalit√© humaine'", "'On verra bien dans le futur'"], correct: 1, feedback: "Parfait. Le fatalisme ignore les √©volutions. Il y a 50 ans : pas de lois, pas de programmes, pas de reconnaissance. Chaque avanc√©e = fruit d'actions. Ton engagement fait partie de cette histoire." },
            { question: "L'histoire montre que les t√©moins passifs permettent la violence. Quelle le√ßon en tirer pour aujourd'hui ?", options: ["Il suffit de punir les harceleurs", "Former les t√©moins est essentiel √† la pr√©vention", "Les t√©moins ne sont pas responsables", "Seuls les adultes peuvent agir"], correct: 1, feedback: "Exact. C'est pourquoi pHARe forme les √©l√®ves ambassadeurs. Les t√©moins form√©s deviennent des d√©fenseurs actifs qui changent les normes du groupe. L'histoire valide cette approche." },
            { question: "Que signifie 'comprendre pour pr√©venir' dans une approche historique ?", options: ["Lire des livres d'histoire", "Analyser le pass√© pour construire des r√©ponses efficaces aujourd'hui", "Juger les erreurs pass√©es", "Attendre que le temps passe"], correct: 1, feedback: "Exact. L'histoire n'est pas un mus√©e mais un outil. Comprendre comment le silence a prot√©g√© les violences permet de construire des dispositifs de parole aujourd'hui. Du pass√©, on tire l'action pr√©sente." }
        ];

        const scenarioData = [
            { title: "Un √©tablissement renforce son action", context: "Un √©tablissement souhaite renforcer son action contre le harc√®lement.", intro: "Quelle d√©marche s'inscrit dans une logique historique coh√©rente ?", choices: [
                { text: "Attendre que les situations apparaissent pour agir.", result: "Erreur. L'histoire montre que cette approche est inefficace. R√©agir apr√®s = des victimes ont d√©j√† souffert. La pr√©vention √©vite cette souffrance. C'est la le√ßon centrale de l'√©volution historique.", impact: { prevention: -30, efficacite: -20 } },
                { text: "Former les √©l√®ves et les adultes √† la pr√©vention.", result: "Exact. La pr√©vention est l'aboutissement des le√ßons du pass√©. Former = donner des outils AVANT les probl√®mes. C'est le socle du programme pHARe et des meilleures pratiques internationales. Tu t'inscris dans cette lign√©e.", impact: { prevention: +40, efficacite: +40 } },
                { text: "Se reposer uniquement sur les sanctions.", result: "Insuffisant. La sanction seule ne pr√©vient pas. Sans travail sur les normes, l'empathie et la dynamique de groupe, les comportements persistent. L'histoire montre la n√©cessit√© d'une approche globale.", impact: { prevention: -10, efficacite: +5 } },
                { text: "Cr√©er un protocole √©crit et le ranger dans un tiroir.", result: "Bureaucratie passive. L'histoire montre qu'un texte sans appropriation collective reste lettre morte. Il faut formation + culture + actions concr√®tes pour que √ßa vive.", impact: { prevention: -15, efficacite: -25 } }
            ]},
            { title: "Le r√¥le de l'adulte vigilant", context: "Un adulte s'interroge sur son r√¥le face au harc√®lement.", intro: "Quelle posture est la plus conforme aux enseignements historiques ?", choices: [
                { text: "Intervenir uniquement en cas de preuve formelle.", result: "Non. Les signaux faibles doivent √™tre pris en compte. Attendre la preuve formelle = laisser la situation s'aggraver. L'histoire montre le co√ªt terrible de l'inaction et de l'attentisme.", impact: { vigilance: -20, protection: -15 } },
                { text: "√ätre vigilant, form√© et attentif aux signaux faibles.", result: "Oui. L'histoire montre l'importance de la vigilance pr√©coce. Les violences s'installent par escalade progressive. D√©tecter les signaux faibles (isolement, changement d'attitude) permet d'intervenir t√¥t et d'√©viter l'aggravation.", impact: { vigilance: +35, protection: +35 } },
                { text: "Consid√©rer que le probl√®me est r√©solu.", result: "Erreur grave. La pr√©vention est un travail continu. Les normes se d√©gradent sans vigilance. Chaque g√©n√©ration doit √™tre form√©e, chaque ann√©e n√©cessite des actions. L'histoire enseigne la permanence de l'effort.", impact: { vigilance: -40, protection: -30 } },
                { text: "Dire 'de mon temps c'√©tait pire, ils exag√®rent'.", result: "Relativisation dangereuse. Ce n'est pas parce que c'√©tait normalis√© avant que c'√©tait acceptable. L'histoire nous enseigne √† ne pas reproduire les erreurs pass√©es mais √† progresser. La souffrance reste souffrance.", impact: { vigilance: -35, protection: -25 } }
            ]},
            { title: "Transmettre la perspective historique", context: "Un √©l√®ve demande pourquoi on parle autant de harc√®lement maintenant.", intro: "Comment utiliser l'histoire pour r√©pondre ?", choices: [
                { text: "Dire 'c'est la mode, √ßa passera'.", result: "Minimisation grave. Ce n'est pas une mode mais une prise de conscience soci√©tale durable. Les lois, programmes et recherches montrent un engagement structurel. Tu nies l'√©volution historique et d√©courages l'action.", impact: { comprehension: -30, engagement: -25 } },
                { text: "Expliquer l'√©volution : du silence √† la reconnaissance.", result: "Parfait. 'Avant, √ßa existait mais on n'avait pas de mot, donc pas d'action. Maintenant qu'on nomme, on peut pr√©venir et prot√©ger. C'est un progr√®s.' Tu utilises l'histoire pour donner du sens et encourager l'engagement.", impact: { comprehension: +40, engagement: +35 } },
                { text: "R√©pondre 'je ne sais pas, c'est comme √ßa'.", result: "Occasion manqu√©e. Tu pouvais transmettre une compr√©hension historique et renforcer l'importance de la pr√©vention. L'ignorance perp√©tue le flou et ne contribue pas √† la culture de vigilance.", impact: { comprehension: +5, engagement: 0 } },
                { text: "Expliquer les lois uniquement sans contexte.", result: "Partiel. Les lois sont importantes mais sans comprendre POURQUOI elles existent (l'histoire du silence, des victimes isol√©es), on perd le sens. L'histoire donne la profondeur qui manque au juridique seul.", impact: { comprehension: +15, engagement: +10 } }
            ]},
            { title: "Devenir ambassadeur¬∑ice", context: "On te propose de devenir ambassadeur¬∑ice anti-harc√®lement.", intro: "Comment la perspective historique √©claire-t-elle ce r√¥le ?", choices: [
                { text: "Tu refuses car '√ßa ne sert √† rien'.", result: "D√©faitisme. L'histoire montre que chaque acteur compte. Les programmes actuels existent parce que des personnes ont agi. Ton refus perp√©tue l'inaction et ignore les le√ßons du pass√©.", impact: { impact_personnel: -25, heritage: -30 } },
                { text: "Tu comprends que tu fais partie d'un mouvement historique de progr√®s.", result: "Magnifique. Tu t'inscris dans une lign√©e : ceux qui ont nomm√© le probl√®me, ceux qui ont cr√©√© les lois, ceux qui forment aujourd'hui. Ton action contribue √† un changement durable. Tu ES l'histoire en train de se faire.", impact: { impact_personnel: +40, heritage: +40 } },
                { text: "Tu acceptes mais sans vraiment comprendre pourquoi.", result: "Engagement fragile. Sans compr√©hension du sens historique, la motivation peut faiblir. Savoir qu'on participe √† un changement social durable donne de la force et de la r√©silience face aux obstacles.", impact: { impact_personnel: +20, heritage: +10 } },
                { text: "Tu acceptes pour avoir une ligne sur ton CV.", result: "Motivation instrumentale. Pas faux mais insuffisant. L'histoire montre que les changements durables viennent de l'engagement authentique, pas des opportunistes. Ton impact sera limit√© sans conviction profonde.", impact: { impact_personnel: +5, heritage: -5 } }
            ]},
            { title: "R√©pondre au parent nostalgique", context: "Un parent dit : '√Ä mon √©poque on se d√©fendait tout seul, pas besoin de tout ce cirque.'", intro: "Comment r√©pondre avec les enseignements historiques ?", choices: [
                { text: "Acquiescer pour ne pas cr√©er de conflit.", result: "Occasion manqu√©e. En ne contestant pas cette vision, tu valides une approche que l'histoire a prouv√© inefficace et destructrice. Le silence des adultes perp√©tue les normes toxiques.", impact: { transmission: -15, changement: -20 } },
                { text: "Expliquer que l'isolement des victimes est pr√©cis√©ment ce qu'on a appris √† √©viter.", result: "Excellent. 'Justement, l'histoire montre que laisser les victimes seules aggrave leur souffrance. Aujourd'hui on sait qu'agir collectivement est plus efficace et humain. C'est un progr√®s, pas un 'cirque'.' Tu √©duques avec respect.", impact: { transmission: +38, changement: +35 } },
                { text: "Dire 'vous √™tes d'une autre g√©n√©ration, vous ne comprenez pas'.", result: "Affrontement sans p√©dagogie. Mieux vaut utiliser l'histoire pour montrer l'√©volution des connaissances : on sait plus, on fait mieux. L'opposition g√©n√©rationnelle bloque le dialogue.", impact: { transmission: +5, changement: -10 } },
                { text: "Ignorer et changer de sujet.", result: "√âvitement. Le parent garde sa vision erron√©e et peut la transmettre √† d'autres. C'√©tait l'occasion d'utiliser l'histoire pour faire √©voluer les mentalit√©s. Une opportunit√© perdue.", impact: { transmission: -5, changement: -15 } }
            ]}
        ];
                { text: "Tu √©cris un guide et tu le laisses au CDI.", result: "Utile mais passif. Un document peut informer, mais sans personnes pour le porter, il restera dans un tiroir. L'√©crit compl√®te la transmission humaine, ne la remplace pas.", impact: { transmission: +15, durabilite: +10 } },
                { text: "Tu organises une grande journ√©e de sensibilisation avant de partir.", result: "Beau geste mais impact ponctuel. Un √©v√©nement marque les esprits mais les normes se construisent au quotidien. Combiner avec la formation de successeurs serait id√©al.", impact: { transmission: +20, durabilite: +15 } }
            ]}
        ];

        function encodeSaveCode(data) { return btoa(JSON.stringify(data)); }
        function decodeSaveCode(code) { try { return JSON.parse(atob(code)); } catch { return null; } }
        function getMasteryLevel(score) {
            if (score >= 500) return { level: "Ma√Ætre¬∑sse de R√©gulation", class: "mastery-master" };
            if (score >= 350) return { level: "R√©gulateur¬∑ice Autonome", class: "mastery-expert" };
            return { level: "Apprenti¬∑e R√©gulation", class: "mastery-confirmed" };
        }

        function App() {
            const [gameState, setGameState] = useState("unlock");
            const [playerData, setPlayerData] = useState({ name: "", class: "", score: 0, xp: 0, quizScore: 0, scenarioScore: 0, finished: false });
            const [unlockCode, setUnlockCode] = useState("");
            const [unlockError, setUnlockError] = useState("");
            const [currentFlashcard, setCurrentFlashcard] = useState(0);
            const [flashcardFlipped, setFlashcardFlipped] = useState(false);
            const [currentQuiz, setCurrentQuiz] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showQuizFeedback, setShowQuizFeedback] = useState(false);
            const [currentScenario, setCurrentScenario] = useState(0);
            const [scenarioChoice, setScenarioChoice] = useState(null);
            const [showScenarioResult, setShowScenarioResult] = useState(false);

            function verifyUnlockCode() {
                const decoded = decodeSaveCode(unlockCode);
                if (!decoded) { setUnlockError("Code invalide."); return; }
                if (decoded.m !== PREREQUISITE_MODULE) { setUnlockError(`Code du module ${decoded.m}. Il te faut celui de ${PREREQUISITE_MODULE}.`); return; }
                if (!decoded.f) { setUnlockError("Module pr√©c√©dent non termin√©."); return; }
                setPlayerData(prev => ({ ...prev, name: decoded.n || "", class: decoded.c || "" }));
                setGameState("intro");
            }

            function nextFlashcard() {
                if (currentFlashcard < flashcardsData.length - 1) {
                    setCurrentFlashcard(prev => prev + 1);
                    setFlashcardFlipped(false);
                    setPlayerData(prev => ({ ...prev, xp: prev.xp + 20 }));
                } else {
                    setGameState("quiz");
                    setPlayerData(prev => ({ ...prev, xp: prev.xp + 100 }));
                }
            }

            function validateQuizAnswer() {
                setShowQuizFeedback(true);
                if (selectedAnswer === quizData[currentQuiz].correct) {
                    setPlayerData(prev => ({ ...prev, score: prev.score + 55, quizScore: prev.quizScore + 55, xp: prev.xp + 55 }));
                }
            }

            function nextQuizQuestion() {
                if (currentQuiz < quizData.length - 1) {
                    setCurrentQuiz(prev => prev + 1);
                    setSelectedAnswer(null);
                    setShowQuizFeedback(false);
                } else {
                    setGameState("scenarios");
                    setPlayerData(prev => ({ ...prev, xp: prev.xp + 100 }));
                }
            }

            function makeScenarioChoice(index) {
                setScenarioChoice(index);
                setShowScenarioResult(true);
                const choice = scenarioData[currentScenario].choices[index];
                const totalChange = Math.max(0, Object.values(choice.impact).reduce((a, b) => a + b, 0));
                setPlayerData(prev => ({ ...prev, score: prev.score + totalChange, scenarioScore: prev.scenarioScore + totalChange, xp: prev.xp + 40 }));
            }

            function nextScenario() {
                if (currentScenario < scenarioData.length - 1) {
                    setCurrentScenario(prev => prev + 1);
                    setScenarioChoice(null);
                    setShowScenarioResult(false);
                } else {
                    setPlayerData(prev => ({ ...prev, finished: true, xp: prev.xp + 150 }));
                    setGameState("complete");
                }
            }

            function generateSaveCode() {
                return encodeSaveCode({ v: 1, d: new Date().toISOString(), m: MODULE_ID, p: PILLAR_ID, n: playerData.name, c: playerData.class, s: playerData.score, x: playerData.xp, f: true, pillarComplete: true });
            }

            function copyCode() { navigator.clipboard.writeText(generateSaveCode()).then(() => alert("Code copi√© !")); }

            if (gameState === "unlock") {
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("div", { className: "pillar-icon" }, "üß†"),
                        e("h1", { className: "glitch-title" }, "PIX-pHARe"),
                        e("div", { className: "subtitle" }, "Pilier Neuro & Empathie"),
                        e("div", { className: "module-badge" }, "‚≠ê CERTIFICATION ‚≠ê")
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üîê"), e("div", { className: "panel-title" }, "Acc√®s Certification")),
                        e("div", { className: "panel-body" },
                            e("div", { className: "unlock-screen" },
                                e("div", { className: "lock-icon" }, "üß†"),
                                e("h2", { className: "unlock-title" }, MODULE_TITLE),
                                e("p", { style: { color: "var(--text-secondary)", marginBottom: "20px" } }, "Code du Module 04 requis pour acc√©der √† la certification."),
                                e("input", { type: "text", className: "code-input", value: unlockCode, onChange: ev => setUnlockCode(ev.target.value), placeholder: "Code du Module 04..." }),
                                unlockError && e("div", { className: "error-msg" }, unlockError),
                                e("div", { style: { marginTop: "25px" } }, e("button", { className: "action-btn", onClick: verifyUnlockCode, disabled: !unlockCode.trim() }, "[ D√âVERROUILLER ]"))
                            )
                        )
                    )
                );
            }

            if (gameState === "intro") {
                return e("div", { className: "app-container" },
                    e("div", { className: "header" },
                        e("div", { className: "pillar-icon" }, "üß†"),
                        e("h1", { className: "glitch-title" }, MODULE_TITLE),
                        e("div", { className: "subtitle" }, "Module 05 - Certification"),
                        e("div", { className: "module-badge" }, "‚≠ê √âPREUVE FINALE ‚≠ê")
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üèÜ"), e("div", { className: "panel-title" }, "Tu es arriv√©¬∑e au bout")),
                        e("div", { className: "panel-body" },
                            e("p", { style: { fontSize: "1.1rem", marginBottom: "20px" } }, e("strong", null, playerData.name), ", tu as travers√© 4 modules neuro. Il est temps de ", e("strong", { style: { color: "var(--neuro-accent)" } }, "tout int√©grer"), "."),
                            e("div", { className: "synthesis-grid" },
                                e("div", { className: "synthesis-card m1" }, e("div", { className: "synthesis-title" }, "Module 01"), e("div", { className: "synthesis-content" }, "Comprendre l'autre")),
                                e("div", { className: "synthesis-card m2" }, e("div", { className: "synthesis-title" }, "Module 02"), e("div", { className: "synthesis-content" }, "Cerveau ado en chantier")),
                                e("div", { className: "synthesis-card m3" }, e("div", { className: "synthesis-title" }, "Module 03"), e("div", { className: "synthesis-content" }, "Nommer ses √©motions")),
                                e("div", { className: "synthesis-card m4" }, e("div", { className: "synthesis-title" }, "Module 04"), e("div", { className: "synthesis-content" }, "Douleur sociale"))
                            ),
                            e("p", { style: { marginBottom: "20px", textAlign: "center" } }, "Ce module final teste ta capacit√© √† ", e("strong", null, "utiliser"), " toutes ces connaissances ET √† ", e("strong", { style: { color: "var(--neuro-success)" } }, "t'autor√©guler"), "."),
                            e("div", { style: { textAlign: "center", marginTop: "30px" } }, e("button", { className: "action-btn", onClick: () => setGameState("flashcards") }, "[ COMMENCER LA CERTIFICATION ]"))
                        )
                    )
                );
            }

            if (gameState === "flashcards") {
                const card = flashcardsData[currentFlashcard];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" }, e("h1", { className: "glitch-title" }, MODULE_TITLE), e("div", { className: "subtitle" }, "Niveau 1 : Synth√®se")),
                    e("div", { className: "progress-bar" }, e("div", { className: "progress-node active" }, "1"), e("div", { className: "progress-node" }, "2"), e("div", { className: "progress-node" }, "3")),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Concept"), e("div", { className: "xp-value" }, `${currentFlashcard + 1}/${flashcardsData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üß†"), e("div", { className: "panel-title" }, "R√©vision Int√©grative")),
                        e("div", { className: "panel-body" },
                            e("div", { className: "flashcard-container" },
                                e("div", { className: `flashcard ${flashcardFlipped ? "flipped" : ""}`, onClick: () => setFlashcardFlipped(!flashcardFlipped) },
                                    e("div", { className: "flashcard-face flashcard-front" },
                                        e("div", { className: "flashcard-badge" }, card.badge),
                                        e("div", { className: "flashcard-question" }, card.question),
                                        e("div", { className: "flashcard-hint" }, card.hint)
                                    ),
                                    e("div", { className: "flashcard-face flashcard-back" },
                                        e("div", { className: "flashcard-badge", style: { background: "var(--leader-emerald)" } }, "MA√éTRIS√â"),
                                        e("div", { className: "flashcard-answer", dangerouslySetInnerHTML: { __html: card.answer } })
                                    )
                                )
                            ),
                            e("div", { className: "flashcard-nav" },
                                e("button", { className: "nav-btn", onClick: () => { setCurrentFlashcard(prev => prev - 1); setFlashcardFlipped(false); }, disabled: currentFlashcard === 0 }, "‚óÑ PR√âC"),
                                e("button", { className: "nav-btn", onClick: nextFlashcard }, currentFlashcard < flashcardsData.length - 1 ? "SUIV ‚ñ∫" : "NIVEAU 2 ‚ñ∫")
                            )
                        )
                    )
                );
            }

            if (gameState === "quiz") {
                const question = quizData[currentQuiz];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" }, e("h1", { className: "glitch-title" }, MODULE_TITLE), e("div", { className: "subtitle" }, "Niveau 2 : Int√©gration")),
                    e("div", { className: "progress-bar" }, e("div", { className: "progress-node completed" }, "‚úì"), e("div", { className: "progress-node active" }, "2"), e("div", { className: "progress-node" }, "3")),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Score"), e("div", { className: "xp-value" }, playerData.quizScore)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Question"), e("div", { className: "xp-value" }, `${currentQuiz + 1}/${quizData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üîó"), e("div", { className: "panel-title" }, "Connexions Conceptuelles")),
                        e("div", { className: "panel-body" },
                            e("div", { className: "quiz-question" }, question.question),
                            e("div", { className: "quiz-options" },
                                question.options.map((opt, idx) => {
                                    let optClass = "quiz-option";
                                    if (showQuizFeedback) { if (idx === question.correct) optClass += " correct"; else if (idx === selectedAnswer) optClass += " incorrect"; }
                                    else if (idx === selectedAnswer) optClass += " selected";
                                    return e("div", { key: idx, className: optClass, onClick: () => { if (!showQuizFeedback) setSelectedAnswer(idx); } },
                                        e("div", { className: "option-marker" }, String.fromCharCode(65 + idx)),
                                        e("div", { className: "option-text" }, opt)
                                    );
                                })
                            ),
                            showQuizFeedback && e("div", { className: `feedback-box ${selectedAnswer !== question.correct ? "incorrect-feedback" : ""}` },
                                e("div", { className: "feedback-title" }, selectedAnswer === question.correct ? "‚úì INT√âGRATION R√âUSSIE" : "‚úó CONNEXION √Ä REVOIR"),
                                e("p", null, question.feedback)
                            ),
                            e("div", { style: { textAlign: "center", marginTop: "25px" } },
                                !showQuizFeedback ? e("button", { className: "action-btn", onClick: validateQuizAnswer, disabled: selectedAnswer === null }, "[ VALIDER ]") :
                                e("button", { className: "action-btn", onClick: nextQuizQuestion }, currentQuiz < quizData.length - 1 ? "[ SUIVANT ]" : "[ NIVEAU 3 ]")
                            )
                        )
                    )
                );
            }

            if (gameState === "scenarios") {
                const scenario = scenarioData[currentScenario];
                return e("div", { className: "app-container" },
                    e("div", { className: "header" }, e("h1", { className: "glitch-title" }, MODULE_TITLE), e("div", { className: "subtitle" }, "Niveau 3 : Transmission")),
                    e("div", { className: "progress-bar" }, e("div", { className: "progress-node completed" }, "‚úì"), e("div", { className: "progress-node completed" }, "‚úì"), e("div", { className: "progress-node active" }, "3")),
                    e("div", { className: "xp-display" },
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "XP Total"), e("div", { className: "xp-value" }, playerData.xp)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "Score"), e("div", { className: "xp-value" }, playerData.score)),
                        e("div", { className: "xp-box" }, e("div", { className: "xp-label" }, "√âpreuve"), e("div", { className: "xp-value" }, `${currentScenario + 1}/${scenarioData.length}`))
                    ),
                    e("div", { className: "content-panel" },
                        e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üåü"), e("div", { className: "panel-title" }, scenario.title)),
                        e("div", { className: "panel-body" },
                            e("div", { className: "scenario-context" }, scenario.context),
                            e("div", { className: "scenario-intro" }, scenario.intro),
                            !showScenarioResult ? e("div", null, scenario.choices.map((choice, idx) => e("button", { key: idx, className: "choice-btn", onClick: () => makeScenarioChoice(idx) }, choice.text))) :
                            e("div", { className: "choice-result" },
                                e("p", { style: { marginBottom: "15px", lineHeight: "1.7" } }, scenario.choices[scenarioChoice].result),
                                e("div", { className: "impact-score" }, Object.entries(scenario.choices[scenarioChoice].impact).map(([key, val]) => e("div", { key: key, className: `impact-item ${val > 0 ? "positive" : "negative"}` }, `${key}: ${val > 0 ? "+" : ""}${val}`))),
                                e("div", { style: { textAlign: "center", marginTop: "25px" } }, e("button", { className: "action-btn", onClick: nextScenario }, currentScenario < scenarioData.length - 1 ? "[ SUIVANT ]" : "[ CERTIFICATION ]"))
                            )
                        )
                    )
                );
            }

            if (gameState === "complete") {
                const mastery = getMasteryLevel(playerData.score);
                return e("div", { className: "app-container" },
                    e("div", { className: "completion-screen" },
                        e("div", { className: "completion-icon" }, "üëë"),
                        e("h1", { className: "completion-title" }, "LEADER POSITIF CERTIFI√â¬∑E"),
                        e("div", { className: `mastery-badge ${mastery.class}` }, mastery.level),
                        e("div", { className: "certificate-frame" },
                            e("div", { className: "certificate-title" }, "CERTIFICAT D'ACCOMPLISSEMENT"),
                            e("div", { className: "certificate-text" }, "Pilier Dynamiques de Groupe"),
                            e("div", { className: "certificate-name" }, playerData.name),
                            e("div", { className: "certificate-text" }, "A compl√©t√© avec succ√®s les 5 modules du pilier et d√©montr√© sa ma√Ætrise des concepts de psychologie sociale du harc√®lement."),
                            e("div", { className: "certificate-text", style: { marginTop: "15px", fontStyle: "italic" } }, "Triangle ‚Ä¢ 5 √âtapes ‚Ä¢ 8 M√©canismes ‚Ä¢ M√©thodes ‚Ä¢ Transmission")
                        ),
                        e("div", { className: "stats-grid" },
                            e("div", { className: "stat-card" }, e("div", { className: "stat-value" }, playerData.score), e("div", { className: "stat-label" }, "Score Final")),
                            e("div", { className: "stat-card" }, e("div", { className: "stat-value" }, playerData.xp), e("div", { className: "stat-label" }, "XP Pilier")),
                            e("div", { className: "stat-card" }, e("div", { className: "stat-value" }, playerData.quizScore), e("div", { className: "stat-label" }, "Int√©gration")),
                            e("div", { className: "stat-card" }, e("div", { className: "stat-value" }, playerData.scenarioScore), e("div", { className: "stat-label" }, "Transmission"))
                        ),
                        e("div", { className: "save-code-box" },
                            e("div", { className: "save-code-label" }, "üìã CODE DE CERTIFICATION DU PILIER GROUPE :"),
                            e("div", { className: "save-code" }, generateSaveCode()),
                            e("button", { className: "copy-btn", onClick: copyCode }, "Copier le code")
                        ),
                        e("div", { className: "content-panel", style: { marginTop: "30px", textAlign: "left" } },
                            e("div", { className: "panel-header" }, e("div", { className: "panel-icon" }, "üöÄ"), e("div", { className: "panel-title" }, "Et maintenant ?")),
                            e("div", { className: "panel-body" },
                                e("p", null, "Tu es maintenant ", e("strong", { style: { color: "var(--leader-gold)" } }, "certifi√©¬∑e Leader Positif"), " du pilier Dynamiques de Groupe."),
                                e("p", { style: { marginTop: "15px" } }, "Ta mission : ", e("strong", null, "cr√©er des normes de protection"), " dans ton environnement et ", e("strong", null, "transmettre"), " ce que tu as appris."),
                                e("p", { style: { marginTop: "15px" } }, "Continue avec les autres piliers : ", e("strong", { style: { color: "var(--leader-cyan)" } }, "Architectes du Num√©rique"), ", ", e("strong", { style: { color: "var(--leader-purple)" } }, "Gardiens du Droit"), ", et bient√¥t ", e("strong", { style: { color: "var(--leader-emerald)" } }, "Histoire du Harc√®lement"), ".")
                            )
                        )
                    )
                );
            }

            return null;
        }

        ReactDOM.createRoot(document.getElementById("root")).render(e(App));
    </script>
</body>
</html>
