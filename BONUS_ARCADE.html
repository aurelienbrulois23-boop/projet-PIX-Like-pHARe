<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>GUARDIAN pHARe - CYBER DEFENSE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Share+Tech+Mono&display=swap');

        body { 
            margin: 0; overflow: hidden; background: #050505; 
            font-family: 'Share Tech Mono', monospace; 
            user-select: none;
        }

        /* EFFET CRT (ÉCRAN CATHODIQUE RETRO) */
        #crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none; z-index: 10;
        }

        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 5; padding: 20px; box-sizing: border-box;
            display: flex; flex-direction: column; justify-content: space-between;
        }

        h1 { 
            font-family: 'Orbitron', sans-serif; color: #00d4ff; 
            text-shadow: 0 0 10px #00d4ff; margin: 0; font-size: 24px; letter-spacing: 2px;
        }

        .hud-top { display: flex; justify-content: space-between; width: 100%; }
        .hud-box { background: rgba(0, 20, 40, 0.7); border: 1px solid #00d4ff; padding: 10px; border-radius: 5px; }

        .bar-container { width: 200px; height: 10px; background: #333; border: 1px solid #555; margin-top: 5px; position: relative; }
        .bar-fill { height: 100%; background: #00ff88; width: 100%; transition: width 0.2s; box-shadow: 0 0 10px #00ff88; }
        
        #score-display { font-size: 2em; color: #ffd700; text-shadow: 0 0 10px #ffd700; }

        /* ÉCRANS (INTRO, GAMEOVER, VICTOIRE) */
        .screen-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 20;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; color: white;
            backdrop-filter: blur(5px);
        }
        
        .hidden { display: none !important; }

        .mission-brief { max-width: 600px; line-height: 1.6; color: #aaa; margin-bottom: 30px; border-left: 3px solid #00d4ff; padding-left: 20px; text-align: left; }
        .highlight { color: #00d4ff; font-weight: bold; }
        .enemy-highlight { color: #ff0044; font-weight: bold; }

        button {
            background: #00d4ff; color: #000; border: none; padding: 15px 40px;
            font-family: 'Orbitron', sans-serif; font-size: 1.2em; cursor: pointer;
            clip-path: polygon(10% 0, 100% 0, 100% 80%, 90% 100%, 0 100%, 0 20%);
            transition: 0.2s; text-transform: uppercase;
        }
        button:hover { background: #fff; transform: scale(1.05); box-shadow: 0 0 20px #00d4ff; }

        canvas { display: block; }

        /* ANIMATION BOSS WARNING */
        #boss-warning {
            position: fixed; top: 30%; width: 100%; text-align: center;
            font-family: 'Orbitron'; font-size: 5em; color: red;
            text-shadow: 0 0 20px red; display: none; z-index: 15;
            animation: blink 0.5s infinite;
        }
        @keyframes blink { 0% {opacity:1;} 50% {opacity:0;} 100% {opacity:1;} }

    </style>
</head>
<body>

<div id="crt-overlay"></div>

<div id="ui-layer">
    <div class="hud-top">
        <div class="hud-box">
            <div>CLIMAT SCOLAIRE</div>
            <div class="bar-container"><div id="climat-bar" class="bar-fill"></div></div>
        </div>
        <div id="score-display">0000</div>
        <div class="hud-box" style="text-align:right">
            <div>SYSTÈME DE DÉFENSE</div>
            <div style="color: #00d4ff">NIVEAU <span id="lvl-display">1</span></div>
            <div id="shield-status" style="color:#555; font-size:0.8em">BOUCLIER: INACTIF</div>
        </div>
    </div>
    <div style="text-align: center; font-size: 0.8em; opacity: 0.5;">
        FLÈCHES ou ZQSD : Mouvement | ESPACE : Tir Photonique
    </div>
</div>

<div id="boss-warning">⚠️ BOSS APPROACHING ⚠️</div>

<div id="start-screen" class="screen-overlay">
    <h1 style="font-size: 3em; margin-bottom: 20px;">GUARDIAN pHARe</h1>
    <div class="mission-brief">
        <p>AGENT, LE RÉSEAU EST COMPROMIS.</p>
        <p>Une vague de <span class="enemy-highlight">CYBER-VIOLENCES</span> s'abat sur l'établissement numérique.</p>
        <p>Votre mission : Intercepter les <span class="enemy-highlight">Rumeurs</span>, bloquer les <span class="enemy-highlight">Insultes</span> et neutraliser le <span class="enemy-highlight">Harcèlement</span> avant que le Climat Scolaire ne s'effondre.</p>
        <p>Atteignez <span class="highlight">1000 POINTS</span> pour débusquer la source du problème.</p>
        <p style="margin-top:20px; font-style: italic;">"La protection, c'est l'action."</p>
    </div>
    <button onclick="startGame()">LANCER LA PATROUILLE</button>
</div>

<div id="gameover-screen" class="screen-overlay hidden">
    <h1 style="color: #ff0044; font-size: 3em;">ÉCHEC SYSTÈME</h1>
    <p>Le Climat Scolaire est devenu toxique.</p>
    <p>SCORE FINAL : <span id="final-score"></span></p>
    <button onclick="location.reload()">RÉINITIALISER</button>
</div>

<div id="victory-screen" class="screen-overlay hidden">
    <h1 style="color: #ffd700; font-size: 3em;">MISSION ACCOMPLIE</h1>
    <p>La menace a été endiguée. Le dialogue peut reprendre.</p>
    <p>SCORE FINAL : <span id="victory-score"></span></p>
    <div style="margin-top:20px; border: 1px solid #ffd700; padding: 20px;">
        <p>BONUS D'XP AJOUTÉ AU HUB</p>
    </div>
    <button onclick="window.close()" style="margin-top:20px; background:#ffd700">RETOUR QG</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
    // ================= CONFIGURATION =================
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Récupération puissance depuis l'URL
    const urlParams = new URLSearchParams(window.location.search);
    const PLAYER_POWER = parseInt(urlParams.get('power')) || 1; 
    
    // Activation du bouclier si niveau suffisant (ex: 3 modules validés)
    const HAS_SHIELD = PLAYER_POWER >= 3;

    document.getElementById('lvl-display').innerText = PLAYER_POWER;
    if(HAS_SHIELD) {
        document.getElementById('shield-status').innerText = "BOUCLIER JURIDIQUE : ACTIF";
        document.getElementById('shield-status').style.color = "#00d4ff";
    }

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // ================= MOTEUR & ÉTATS =================
    const GAME = {
        active: false,
        score: 0,
        frame: 0,
        climat: 100, // Santé globale
        bossMode: false,
        bossSpawned: false
    };

    const INPUT = { left: false, right: false, up: false, down: false, fire: false };

    // ================= CLASSES =================

    // --- FOND (SCROLLING GRID) ---
    class Background {
        constructor() {
            this.offsetY = 0;
            this.speed = 2;
        }
        update() {
            this.offsetY += this.speed;
            if(this.offsetY > 40) this.offsetY = 0;
        }
        draw() {
            // Fond noir profond
            ctx.fillStyle = '#050505';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Grille "Tron"
            ctx.strokeStyle = 'rgba(0, 212, 255, 0.15)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            
            // Lignes verticales (perspective)
            const centerX = canvas.width / 2;
            for(let i = -10; i <= 10; i++) {
                const x = centerX + (i * 100);
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
            }
            
            // Lignes horizontales (scrolling)
            for(let y = this.offsetY; y < canvas.height; y += 40) {
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
            }
            ctx.stroke();

            // Murs latéraux (Bio-mécanique Xenon)
            ctx.fillStyle = '#111';
            ctx.fillRect(0, 0, 50, canvas.height);
            ctx.fillRect(canvas.width - 50, 0, 50, canvas.height);
            
            ctx.strokeStyle = '#333';
            ctx.beginPath();
            for(let y = this.offsetY; y < canvas.height; y += 80) {
                // Détails tech sur les murs
                ctx.moveTo(10, y); ctx.lineTo(40, y+20); ctx.lineTo(10, y+40);
                ctx.moveTo(canvas.width-10, y); ctx.lineTo(canvas.width-40, y+20); ctx.lineTo(canvas.width-10, y+40);
            }
            ctx.stroke();
        }
    }

    // --- JOUEUR ---
    class Player {
        constructor() {
            this.w = 40; this.h = 50;
            this.x = canvas.width / 2;
            this.y = canvas.height - 100;
            this.speed = 8;
            this.lastShot = 0;
            this.fireRate = Math.max(5, 15 - PLAYER_POWER); // Plus rapide avec le niveau
            this.shield = HAS_SHIELD;
            this.invincible = 0;
        }
        update() {
            if (INPUT.left && this.x > 60) this.x -= this.speed;
            if (INPUT.right && this.x < canvas.width - 60) this.x += this.speed;
            if (INPUT.up && this.y > 50) this.y -= this.speed;
            if (INPUT.down && this.y < canvas.height - 50) this.y += this.speed;

            if (INPUT.fire && GAME.frame - this.lastShot > this.fireRate) {
                this.shoot();
                this.lastShot = GAME.frame;
            }
            if(this.invincible > 0) this.invincible--;
        }
        shoot() {
            // Tir central
            bullets.push(new Bullet(this.x, this.y - 20, 0, -12, 'PLAYER'));
            
            // Tir latéraux (Power >= 2)
            if (PLAYER_POWER >= 2) {
                bullets.push(new Bullet(this.x - 15, this.y, -1, -10, 'PLAYER'));
                bullets.push(new Bullet(this.x + 15, this.y, 1, -10, 'PLAYER'));
            }
            // Tir Arrière/Diagonale (Power >= 5 - Xenon Style)
            if (PLAYER_POWER >= 5) {
                bullets.push(new Bullet(this.x - 25, this.y + 10, -3, -8, 'PLAYER'));
                bullets.push(new Bullet(this.x + 25, this.y + 10, 3, -8, 'PLAYER'));
            }
        }
        draw() {
            if(this.invincible > 0 && GAME.frame % 4 === 0) return; // Clignotement

            ctx.save();
            ctx.translate(this.x, this.y);

            // Bouclier Juridique
            if (this.shield) {
                ctx.strokeStyle = `rgba(0, 255, 255, ${Math.abs(Math.sin(GAME.frame/10)) + 0.5})`;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(0, 0, 40, 0, Math.PI*2);
                ctx.stroke();
            }

            // Vaisseau
            ctx.fillStyle = '#eee';
            ctx.beginPath(); // Corps principal
            ctx.moveTo(0, -25); ctx.lineTo(15, 10); ctx.lineTo(0, 25); ctx.lineTo(-15, 10);
            ctx.fill();

            ctx.fillStyle = '#00d4ff'; // Ailes
            ctx.beginPath();
            ctx.moveTo(-15, 10); ctx.lineTo(-25, 20); ctx.lineTo(-15, 25);
            ctx.moveTo(15, 10); ctx.lineTo(25, 20); ctx.lineTo(15, 25);
            ctx.fill();

            // Réacteur
            ctx.fillStyle = '#ffaa00';
            ctx.shadowColor = '#ffaa00';
            ctx.shadowBlur = 10;
            ctx.beginPath();
            ctx.moveTo(-5, 25); ctx.lineTo(5, 25); ctx.lineTo(0, 35 + Math.random()*10);
            ctx.fill();

            ctx.restore();
        }
        hit() {
            if (this.invincible > 0) return;

            if (this.shield) {
                this.shield = false; // Perte du bouclier
                this.invincible = 60; // 1 sec invulnérabilité
                particles.push(new Explosion(this.x, this.y, '#00ffff'));
                document.getElementById('shield-status').innerText = "BOUCLIER : DÉTRUIT";
                document.getElementById('shield-status').style.color = "red";
                screenShake = 10;
            } else {
                damageClimat(20); // Dégâts majeurs au climat
                this.invincible = 30;
                screenShake = 20;
                particles.push(new Explosion(this.x, this.y, '#ff0000'));
            }
        }
    }

    // --- ENNEMIS ---
    class Enemy {
        constructor(type) {
            this.type = type; // 'RUMEUR', 'TROLL', 'HARCELEMENT'
            this.x = Math.random() * (canvas.width - 150) + 75;
            this.y = -50;
            this.active = true;
            this.frameOffset = Math.random() * 100;
            
            if (type === 'RUMEUR') {
                this.w = 30; this.h = 30; this.hp = 1; this.speed = 4; this.score = 50; this.color = '#ffff00';
            } else if (type === 'TROLL') {
                this.w = 40; this.h = 40; this.hp = 3; this.speed = 2; this.score = 100; this.color = '#ff0044';
            } else { // HARCELEMENT (Tank)
                this.w = 60; this.h = 60; this.hp = 10; this.speed = 1; this.score = 300; this.color = '#9900ff';
            }
        }
        update() {
            this.y += this.speed;
            
            // Mouvement sinusoïdal pour les rumeurs
            if (this.type === 'RUMEUR') {
                this.x += Math.sin((GAME.frame + this.frameOffset) / 20) * 2;
            }

            // Tir des Trolls
            if (this.type === 'TROLL' && GAME.frame % 120 === 0) {
                 bullets.push(new Bullet(this.x, this.y + 20, 0, 5, 'ENEMY'));
            }

            // Sortie d'écran (Pénalité Climat)
            if (this.y > canvas.height) {
                this.active = false;
                damageClimat(this.type === 'HARCELEMENT' ? 15 : 5);
            }

            // Collision Joueur
            const dist = Math.hypot(this.x - player.x, this.y - player.y);
            if (dist < (this.w/2 + player.w/2)) {
                this.active = false;
                player.hit();
                particles.push(new Explosion(this.x, this.y, this.color));
            }
        }
        draw() {
            ctx.save();
            ctx.translate(this.x, this.y);
            
            ctx.shadowBlur = 10;
            ctx.shadowColor = this.color;
            ctx.fillStyle = this.color;

            if (this.type === 'RUMEUR') {
                // Forme triangle (rapide)
                ctx.beginPath(); ctx.moveTo(0, 15); ctx.lineTo(15, -15); ctx.lineTo(-15, -15); ctx.fill();
            } else if (this.type === 'TROLL') {
                // Carré agressif
                ctx.fillRect(-20, -20, 40, 40);
                ctx.fillStyle = '#000'; ctx.fillRect(-10, -5, 20, 5); // Bouche
            } else {
                // Hexagone (Lourd)
                ctx.beginPath(); 
                for (let i = 0; i < 6; i++) {
                    ctx.lineTo(30 * Math.cos(i * 2 * Math.PI / 6), 30 * Math.sin(i * 2 * Math.PI / 6));
                }
                ctx.fill();
                ctx.fillStyle = '#fff'; ctx.font="20px monospace"; ctx.fillText("!!!", -15, 5);
            }
            ctx.restore();
        }
        takeDamage(dmg) {
            this.hp -= dmg;
            if (this.hp <= 0) {
                this.active = false;
                GAME.score += this.score;
                particles.push(new Explosion(this.x, this.y, this.color));
                // Récupération Climat (Petite récompense)
                GAME.climat = Math.min(100, GAME.climat + 2);
                updateUI();
            }
        }
    }

    // --- BOSS ---
    class Boss {
        constructor() {
            this.x = canvas.width / 2;
            this.y = -100;
            this.w = 150; this.h = 100;
            this.hp = 500;
            this.maxHp = 500;
            this.phase = 'ENTERING'; // ENTERING, FIGHT, DYING
            this.angle = 0;
            this.dir = 1;
        }
        update() {
            if (this.phase === 'ENTERING') {
                this.y += 2;
                if (this.y >= 100) this.phase = 'FIGHT';
            } else if (this.phase === 'FIGHT') {
                // Mouvement latéral
                this.x += 2 * this.dir;
                if (this.x > canvas.width - 100 || this.x < 100) this.dir *= -1;

                // Tirs Patterns
                if (GAME.frame % 60 === 0) { // Tir éventail
                    for(let i=-2; i<=2; i++) bullets.push(new Bullet(this.x, this.y+50, i, 6, 'ENEMY'));
                }
                if (GAME.frame % 200 === 0) { // Tir ciblé
                    const angle = Math.atan2(player.y - this.y, player.x - this.x);
                    bullets.push(new Bullet(this.x, this.y, Math.cos(angle)*8, Math.sin(angle)*8, 'ENEMY'));
                }
            }
        }
        draw() {
            ctx.save();
            ctx.translate(this.x, this.y);
            
            // Aura menaçante
            ctx.shadowBlur = 20; ctx.shadowColor = 'red';
            
            // Corps
            ctx.fillStyle = '#aa0000';
            ctx.beginPath();
            ctx.moveTo(0, 60); ctx.lineTo(80, -40); ctx.lineTo(0, -20); ctx.lineTo(-80, -40);
            ctx.fill();

            // Yeux
            ctx.fillStyle = '#fff';
            ctx.fillRect(-30, 0, 20, 10);
            ctx.fillRect(10, 0, 20, 10);

            // Barre de vie du boss
            ctx.fillStyle = '#333'; ctx.fillRect(-75, -60, 150, 10);
            ctx.fillStyle = 'red'; ctx.fillRect(-75, -60, 150 * (this.hp/this.maxHp), 10);

            ctx.restore();
        }
        takeDamage(dmg) {
            if (this.phase !== 'FIGHT') return;
            this.hp -= dmg;
            if (this.hp <= 0) {
                // VICTOIRE !
                GAME.active = false;
                particles.push(new Explosion(this.x, this.y, '#fff', 100));
                setTimeout(() => {
                    document.getElementById('victory-screen').classList.remove('hidden');
                    document.getElementById('victory-score').innerText = GAME.score + 5000;
                }, 2000);
            }
        }
    }

    // --- PROJECTILES & EFFETS ---
    class Bullet {
        constructor(x, y, dx, dy, source) {
            this.x = x; this.y = y; this.dx = dx; this.dy = dy;
            this.source = source; // 'PLAYER' or 'ENEMY'
            this.active = true;
        }
        update() {
            this.x += this.dx; this.y += this.dy;
            if (this.y < 0 || this.y > canvas.height) this.active = false;
        }
        draw() {
            ctx.fillStyle = this.source === 'PLAYER' ? '#00ffff' : '#ff0000';
            ctx.shadowBlur = 5; ctx.shadowColor = ctx.fillStyle;
            ctx.fillRect(this.x-3, this.y-3, 6, 6);
        }
    }

    class Explosion {
        constructor(x, y, color, size=20) {
            this.x = x; this.y = y; this.color = color;
            this.life = 1.0;
            this.parts = [];
            for(let i=0; i<size; i++) {
                this.parts.push({
                    vx: (Math.random()-0.5)*10, 
                    vy: (Math.random()-0.5)*10,
                    size: Math.random()*4
                });
            }
        }
        update() {
            this.life -= 0.05;
            this.parts.forEach(p => {
                p.vx *= 0.9; p.vy *= 0.9;
            });
        }
        draw() {
            ctx.globalAlpha = this.life;
            ctx.fillStyle = this.color;
            this.parts.forEach(p => {
                ctx.fillRect(this.x + p.vx * 10 * (1-this.life), this.y + p.vy * 10 * (1-this.life), p.size, p.size);
            });
            ctx.globalAlpha = 1;
        }
    }

    // ================= VARIABLES GLOBALES =================
    const bg = new Background();
    const player = new Player();
    let bullets = [];
    let enemies = [];
    let particles = [];
    let boss = null;
    let screenShake = 0;

    // ================= LOGIQUE JEU =================

    function startGame() {
        document.getElementById('start-screen').classList.add('hidden');
        GAME.active = true;
        loop();
    }

    function damageClimat(amount) {
        GAME.climat = Math.max(0, GAME.climat - amount);
        updateUI();
        screenShake = 5;
        if (GAME.climat <= 0) {
            GAME.active = false;
            document.getElementById('gameover-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = GAME.score;
        }
    }

    function updateUI() {
        document.getElementById('score-display').innerText = GAME.score.toString().padStart(4, '0');
        const bar = document.getElementById('climat-bar');
        bar.style.width = GAME.climat + '%';
        if (GAME.climat < 30) { bar.style.backgroundColor = 'red'; bar.style.boxShadow = '0 0 10px red'; }
        else { bar.style.backgroundColor = '#00ff88'; bar.style.boxShadow = '0 0 10px #00ff88'; }
    }

    function spawnManager() {
        if (boss) return; // Pas d'ennemis pendant le boss

        // Déclenchement Boss
        if (GAME.score >= 1000 && !GAME.bossMode) {
            GAME.bossMode = true;
            document.getElementById('boss-warning').style.display = 'block';
            setTimeout(() => {
                document.getElementById('boss-warning').style.display = 'none';
                boss = new Boss();
            }, 3000);
            return;
        }

        // Spawn Ennemis
        if (GAME.frame % 60 === 0) {
            const rand = Math.random();
            let type = 'RUMEUR';
            if (rand > 0.7) type = 'TROLL';
            if (rand > 0.9) type = 'HARCELEMENT';
            enemies.push(new Enemy(type));
        }
    }

    function loop() {
        if (!GAME.active) return;

        // Effet Screen Shake
        let dx = 0, dy = 0;
        if (screenShake > 0) {
            dx = (Math.random() - 0.5) * screenShake;
            dy = (Math.random() - 0.5) * screenShake;
            screenShake *= 0.9;
            if(screenShake < 0.5) screenShake = 0;
        }

        ctx.save();
        ctx.translate(dx, dy);

        // Update & Draw
        bg.update(); bg.draw();

        if (boss) { boss.update(); boss.draw(); }
        
        player.update(); player.draw();

        GAME.frame++;
        spawnManager();

        // Gestion Balles
        bullets = bullets.filter(b => b.active);
        bullets.forEach(b => {
            b.update(); b.draw();
            
            // Collisions Balles -> Ennemis / Boss
            if (b.source === 'PLAYER') {
                if (boss && b.x > boss.x - 40 && b.x < boss.x + 40 && b.y > boss.y - 40 && b.y < boss.y + 60) {
                    boss.takeDamage(10);
                    b.active = false;
                    particles.push(new Explosion(b.x, b.y, '#fff', 5));
                }
                enemies.forEach(e => {
                    if (e.active && Math.hypot(b.x - e.x, b.y - e.y) < e.w) {
                        e.takeDamage(10);
                        b.active = false;
                    }
                });
            } else { // Balles Ennemies -> Joueur
                if (Math.hypot(b.x - player.x, b.y - player.y) < 20) {
                    player.hit();
                    b.active = false;
                }
            }
        });

        // Gestion Ennemis
        enemies = enemies.filter(e => e.active);
        enemies.forEach(e => e.update());
        enemies.forEach(e => e.draw());

        // Particules
        particles = particles.filter(p => p.life > 0);
        particles.forEach(p => { p.update(); p.draw(); });

        ctx.restore();
        
        updateUI();
        requestAnimationFrame(loop);
    }

    // ================= CONTROLES =================
    window.addEventListener('keydown', e => {
        if(e.key === 'ArrowLeft' || e.key === 'q') INPUT.left = true;
        if(e.key === 'ArrowRight' || e.key === 'd') INPUT.right = true;
        if(e.key === 'ArrowUp' || e.key === 'z') INPUT.up = true;
        if(e.key === 'ArrowDown' || e.key === 's') INPUT.down = true;
        if(e.key === ' ') INPUT.fire = true;
    });

    window.addEventListener('keyup', e => {
        if(e.key === 'ArrowLeft' || e.key === 'q') INPUT.left = false;
        if(e.key === 'ArrowRight' || e.key === 'd') INPUT.right = false;
        if(e.key === 'ArrowUp' || e.key === 'z') INPUT.up = false;
        if(e.key === 'ArrowDown' || e.key === 's') INPUT.down = false;
        if(e.key === ' ') INPUT.fire = false;
    });

</script>
</body>
</html>